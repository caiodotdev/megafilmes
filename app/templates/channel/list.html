{% extends 'base.html' %}
{% load static %}
{% load form_utils %}
{% block content %}
    <div class="row">
        <div class="col-sm-3 col-xs-12">
            <h2> {{ model_name_plural }}</h2>
        </div>
        <div class="col-sm-9 col-xs-12">

            <button id="get_channels" type="button" class="btn btn-info pull-right h2"><i
                    class="fa fa-rocket"></i> Get Channels
            </button>
{#            <button id="get_m3u8" type="button" class="btn btn-info pull-right h2"><i#}
{#                    class="fa fa-tv"></i> Get M3U8#}
{#            </button>#}
            {#            <a href="{% url 'delete_all_channels' %}" class="btn btn-danger pull-right h2"><i#}
            {#                    class="fa fa-trash"></i> Delete All#}
            {#            </a>#}
        </div>
    </div> <!-- /#top -->
    <hr/>

    <div class="row">
        {% for channel in channels %}
            <div class="col-xs-2">
                <div class="panel panel-default">
                    <div class="panel-body text-center">
                        <div class="row text-center">
                            <div class="col-xs-12">
                                <img src="{{ channel.image }}"
                                     class="img-responsive" style="height: 120px; width: 100%"/>
                            </div>
                        </div>
                        <div class="row">
                            <p>{{ channel.title|truncatechars:16 }}</p>
                        </div>


                    </div>
                    <div class="panel-footer text-center">
                        <a href="{% url 'CHANNEL_detail' channel.pk %}" class="btn btn-primary">
                            <i class="fa fa-eye"></i>
                            Assistir
                        </a>

                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <script type="text/javascript">

        $(document).ready(function () {

            $('#channel_link').addClass('active');

            $('#get_channels').click(function () {
                $('#loading').show();
                $.get("{% url 'get_channels' %}", function (data) {
                    console.log('Getting channels ...');
                }).done(function (data) {
                    $('#loading').hide();
                    window.location.href = '';
                    console.log(data);
                }).fail(function () {
                    $('#loading').hide();
                });
            });

            $('#get_m3u8').click(function () {
                $('#loading').show();
                $.get("{% url 'get_channels_m3u8' %}", function (data) {
                    console.log('Getting channels m3u8 for all ...');
                }).done(function (data) {
                    $('#loading').hide();
                    window.location.href = '';
                    console.log(data);
                }).fail(function () {
                    $('#loading').hide();
                });
            });

        });
    </script>

{% endblock %}
